<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper	namespace="boardMapper">

	<resultMap id="boardResultMap" type="BoardDto">
		<result column="board_no" property="boardNo" />
		<result column="board_title" property="boardTitle" />
		<result column="user_id" property="boardWriter" />
		<result column="count" property="count" />
		<result column="regist_date" property="registDt" />
		<result column="attach_count" property="attachCount" />
	</resultMap>

	<select id="selectBoardListCount" resultType="_int">
		select 
					 count(*)
			from board
		 where status = 'Y'
	</select>
	
	<select id="selectBoardList" resultMap="boardResultMap">
		select
		       b.board_no
		     , board_title
		     , user_id
		     , count
		     , to_char(regist_date, 'YYYY-MM-DD') as "regist_date"
		     , (
		         select count(*)
		           from attachment
		          where ref_type = 'B'
		            and ref_no = b.board_no
		       ) as "attach_count"
		  from board b
		  join member on (user_no = board_writer)
		 where b.status = 'Y'
		 order by board_no desc
	</select>

	<select id="selectSearchListCount" resultType="_int">
		select 
					 count(*)
			from board
			join member on (user_no = board_writer)
		 where status = 'Y'
		   and ${condition} like '%' || #{keyword} || '%'
	</select>

	<select id="selectSearchList" resultMap="boardResultMap">
		select
		       b.board_no
		     , board_title
		     , user_id
		     , count
		     , to_char(regist_date, 'YYYY-MM-DD') as "regist_date"
		     , (
		         select count(*)
		           from attachment
		          where ref_type = 'B'
		            and ref_no = b.board_no
		       ) as "attach_count"
		  from board b
		  join member on (user_no = board_writer)
		 where b.status = 'Y'
		   and ${condition} like '%' || #{keyword} || '%'
		 order by board_no desc
	</select>
	
	
	
	
	
	
	
	
	
	
	
	

</mapper>
